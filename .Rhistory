# Compute the maximum values for the specified columns. To noramlise to 1 we will need to know the max value present for each variable in the full dataset, this will be listed in a vector called max_values.
filtsummarydata <- summary_data %>%
filter(MatchesTotal>19)
max_values <- apply(filtsummarydata[,columns_to_normalize], 2, max,na.rm=TRUE)
# Normalize the specified columns (column values / max_values)
normalized_columns <- sweep(filtsummarydata[, columns_to_normalize], 2, max_values, "/")
colnames(normalized_columns) <- paste('Norm', colnames(normalized_columns), sep = '_')
# Add the normalized columns back to the filtered data frame
filtsummarydata <- cbind(filtsummarydata, normalized_columns)
# Filter for specific athletes (here we filter for top 5 batting strike rate)
top5StrikeRate <- filtsummarydata %>%
arrange(desc(BattingStrikeRate)) %>%
slice(1:5)
# Select the data for the radar chart
radar_data <- top5StrikeRate[,c("Norm_BattingStrikeRate", "Norm_BattingAverage", "Norm_NotOutRate", "Norm_PercBoundaries", "Innings.Player")]
radar_data <- data.frame(BattingStrikeRate = c(1, 0, radar_data$Norm_BattingStrikeRate),
BattingAverage = c(1, 0, radar_data$Norm_BattingAverage),
NotOutRate = c(1, 0, radar_data$Norm_NotOutRate),
PercBoundaries = c(1, 0, radar_data$Norm_PercBoundaries),
row.names=c("max","min",radar_data$Innings.Player),
colors <- c("red", "green", "blue", "yellow", "purple"),
legend("bottom", legend = rownames(radar_data)[-c(1,2)], pch = 20, col = colors, cex = 1, bty = "n"))
radar_data <- top5StrikeRate[,c("Norm_BattingStrikeRate", "Norm_BattingAverage", "Norm_NotOutRate", "Norm_PercBoundaries", "Innings.Player")]
radar_data <- data.frame(BattingStrikeRate = c(1, 0, radar_data$Norm_BattingStrikeRate),
BattingAverage = c(1, 0, radar_data$Norm_BattingAverage),
NotOutRate = c(1, 0, radar_data$Norm_NotOutRate),
PercBoundaries = c(1, 0, radar_data$Norm_PercBoundaries),
row.names=c("max","min",radar_data$Innings.Player),
colors <- c("red", "green", "blue", "yellow", "purple"))
radar_data <- top5StrikeRate[,c("Norm_BattingStrikeRate", "Norm_BattingAverage", "Norm_NotOutRate", "Norm_PercBoundaries", "Innings.Player")]
radar_data <- data.frame(BattingStrikeRate = c(1, 0, radar_data$Norm_BattingStrikeRate),
BattingAverage = c(1, 0, radar_data$Norm_BattingAverage),
NotOutRate = c(1, 0, radar_data$Norm_NotOutRate),
PercBoundaries = c(1, 0, radar_data$Norm_PercBoundaries),
row.names=c("max","min",radar_data$Innings.Player),
colors <- c("red", "green", "blue", "yellow", "purple"))
radar_data <- top5StrikeRate[,c("Norm_BattingStrikeRate", "Norm_BattingAverage", "Norm_NotOutRate", "Norm_PercBoundaries", "Innings.Player")]
radar_data <- data.frame(BattingStrikeRate = c(1, 0, radar_data$Norm_BattingStrikeRate),
BattingAverage = c(1, 0, radar_data$Norm_BattingAverage),
NotOutRate = c(1, 0, radar_data$Norm_NotOutRate),
PercBoundaries = c(1, 0, radar_data$Norm_PercBoundaries),
row.names=c("max","min",radar_data$Innings.Player),
# Create the radar chart
radar_plot <- radarchart(radar_data)
source("~/Desktop/MASTERS DEGREE/Course Material/B1701/Week 7/Lecture/B1701Week7/B1701RecruitmentAnalyticsinR.R", echo=TRUE)
rm(list = 'ls')
rm(list = ls())
source("~/Desktop/MASTERS DEGREE/Course Material/B1701/Week 7/Lecture/B1701Week7/B1701RecruitmentAnalyticsinR.R", echo=TRUE)
radar_data <- top5StrikeRate[,c("Norm_BattingStrikeRate", "Norm_BattingAverage", "Norm_NotOutRate", "Norm_PercBoundaries", "Innings.Player")]
radar_data <- data.frame(BattingStrikeRate = c(1, 0, radar_data$Norm_BattingStrikeRate),
BattingAverage = c(1, 0, radar_data$Norm_BattingAverage),
NotOutRate = c(1, 0, radar_data$Norm_NotOutRate),
PercBoundaries = c(1, 0, radar_data$Norm_PercBoundaries),
row.names=c("max","min",radar_data$Innings.Player))
legend("topleft", legend=row.names(radar_data), col=rainbow(length(row.names(radar_data))), lwd=3, cex=0.8, title="Players", text.font=4, bg='lightblue')
View(radar_data)
radar_data <- top5StrikeRate[,c("Norm_BattingStrikeRate", "Norm_BattingAverage", "Norm_NotOutRate", "Norm_PercBoundaries", "Innings.Player")]
radar_data <- data.frame(BattingStrikeRate = c(1, 0, radar_data$Norm_BattingStrikeRate),
BattingAverage = c(1, 0, radar_data$Norm_BattingAverage),
NotOutRate = c(1, 0, radar_data$Norm_NotOutRate),
PercBoundaries = c(1, 0, radar_data$Norm_PercBoundaries),
row.names=c("max","min",radar_data$Innings.Player))
legend("topleft", legend=row.name(radar_data, 3:7), col=rainbow(length(row.names(radar_data))), lwd=3, cex=0.8, title="Players", text.font=4, bg='lightblue')
radar_data <- top5StrikeRate[,c("Norm_BattingStrikeRate", "Norm_BattingAverage", "Norm_NotOutRate", "Norm_PercBoundaries", "Innings.Player")]
radar_data <- data.frame(BattingStrikeRate = c(1, 0, radar_data$Norm_BattingStrikeRate),
BattingAverage = c(1, 0, radar_data$Norm_BattingAverage),
NotOutRate = c(1, 0, radar_data$Norm_NotOutRate),
PercBoundaries = c(1, 0, radar_data$Norm_PercBoundaries),
row.names=c("max","min",radar_data$Innings.Player))
legend("topleft", legend=row.name(radar_data), col=rainbow(length(row.names(radar_data))), lwd=3, cex=0.8, title="Players", text.font=4, bg='lightblue')
radar_data <- top5StrikeRate[,c("Norm_BattingStrikeRate", "Norm_BattingAverage", "Norm_NotOutRate", "Norm_PercBoundaries", "Innings.Player")]
radar_data <- data.frame(BattingStrikeRate = c(1, 0, radar_data$Norm_BattingStrikeRate),
BattingAverage = c(1, 0, radar_data$Norm_BattingAverage),
NotOutRate = c(1, 0, radar_data$Norm_NotOutRate),
PercBoundaries = c(1, 0, radar_data$Norm_PercBoundaries),
row.names=c("max","min",radar_data$Innings.Player))
legend("topleft", legend=row.names(radar_data), col=rainbow(length(row.names(radar_data))), lwd=3, cex=0.8, title="Players", text.font=4, bg='lightblue')
radar_data <- top5StrikeRate[,c("Norm_BattingStrikeRate", "Norm_BattingAverage", "Norm_NotOutRate", "Norm_PercBoundaries", "Innings.Player")]
radar_data <- data.frame(BattingStrikeRate = c(1, 0, radar_data$Norm_BattingStrikeRate),
BattingAverage = c(1, 0, radar_data$Norm_BattingAverage),
NotOutRate = c(1, 0, radar_data$Norm_NotOutRate),
PercBoundaries = c(1, 0, radar_data$Norm_PercBoundaries),
row.names=c("max","min",radar_data$Innings.Player))
legend("topleft", legend=row.names(radar_data, 3:7), col=rainbow(length(row.names(radar_data))), lwd=3, cex=0.8, title="Players", text.font=4, bg='lightblue')
radar_data <- top5StrikeRate[,c("Norm_BattingStrikeRate", "Norm_BattingAverage", "Norm_NotOutRate", "Norm_PercBoundaries", "Innings.Player")]
radar_data <- data.frame(BattingStrikeRate = c(1, 0, radar_data$Norm_BattingStrikeRate),
BattingAverage = c(1, 0, radar_data$Norm_BattingAverage),
NotOutRate = c(1, 0, radar_data$Norm_NotOutRate),
PercBoundaries = c(1, 0, radar_data$Norm_PercBoundaries),
row.names=c("max","min",radar_data$Innings.Player))
legend("topleft", legend=row.names(c(3:7)), col=rainbow(length(row.names(radar_data))), lwd=3, cex=0.8, title="Players", text.font=4, bg='lightblue')
radar_data <- top5StrikeRate[,c("Norm_BattingStrikeRate", "Norm_BattingAverage", "Norm_NotOutRate", "Norm_PercBoundaries", "Innings.Player")]
radar_data <- data.frame(BattingStrikeRate = c(1, 0, radar_data$Norm_BattingStrikeRate),
BattingAverage = c(1, 0, radar_data$Norm_BattingAverage),
NotOutRate = c(1, 0, radar_data$Norm_NotOutRate),
PercBoundaries = c(1, 0, radar_data$Norm_PercBoundaries),
row.names=c("max","min",radar_data$Innings.Player))
# Create the radar chart
radar_plot <- radarchart(radar_data)
LoIWing <- read.csv("/Users/seanmccrone/Desktop/MASTERS DEGREE/Course Material/B1701/Week 7/Guest Speaker - Declan McKean Data/LoIWingers")
LoIWing <- read.csv("/Users/seanmccrone/Desktop/MASTERS DEGREE/Course Material/B1701/Week 7/Guest Speaker - Declan McKean Data/LoIWingers.csv")
LoIWing <- read.csv("/Users/seanmccrone/Desktop/MASTERS DEGREE/Course Material/B1701/Week 7/ClassPractical/LoIWingers.csv")
rm(list = ls())
LoIWing <- read.csv("/Users/seanmccrone/Desktop/MASTERS DEGREE/Course Material/B1701/Week 7/ClassPractical/LoIWingers.csv")
LoIWing <- read.csv("/Users/seanmccrone/Desktop/MASTERS DEGREE/Course Material/B1701/Week 7/ClassPractical/LoIWingers.csv")
View(LoIWing)
str(LoIWing)
LoISummary <- LoIWing %>%
select.list(c(84))
LoISummary <- LoIWing %>%
filter(Minutes.played > 1500) %>%
arrange(desc(xG)) %>%
LoISummary <- LoIWing %>%
filter(Minutes.played > 1500) %>%
arrange(desc(xG)) %>%
LoISummary <- LoIWing %>%
filter(Minutes.played > 1500) %>%
arrange(desc(xG) %>%
LoISummary <- LoIWing %>%
filter(Minutes.played > 1500) %>%
arrange(desc(xG)) %>%
slice(1:10)
LoISummary <- LoIWing %>%
filter(Minutes.played > 1500) +
arrange(desc(xG)) +
slice(1:10)
LoISummary <- LoIWing %>%
filter(Minutes.played > 1500) %>%
LoISummary <- c("xG", "xA")
LoISummary <- c("xG", "xA")
LoIWing %>%
arrange(desc(xG)) +
slice(1:10)
library(tidyverse)
LoIWing <- read.csv("/Users/seanmccrone/Desktop/MASTERS DEGREE/Course Material/B1701/Week 7/ClassPractical/LoIWingers.csv")
str(LoIWing)
LoIWing %>%
arrange(desc(xG)) +
slice(1:10)
LoIWing %>%
arrange(desc(xG))
FilteredLoIWing <- LoIWing %>%
select('Minutes.played', 'xG', 'xA', 'Crosses.per.90') %>%
filter(`Minutes.played` > 1500)
str(FilteredLoIWing)
View(FilteredLoIWing)
# Create a new filtered dataset
FilteredLoIWing <- LoIWing %>%
select(1:7, 'Minutes.played', 'xG', 'xA', 'Crosses.per.90') %>%
filter(`Minutes.played` > 1500)
str(FilteredLoIWing)
View(FilteredLoIWing)
FilteredLoIWing <- LoIWing %>%
select(1:7, 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90') %>%
filter(`Minutes.played` > 1500)
str(FilteredLoIWing)
FilteredLoIWing <- LoIWing %>%
select(1:7,'Duels.won...', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90') %>%
filter(`Minutes.played` > 1200)
str(FilteredLoIWing)
# Convert 'Contract.expires' to Date format
LoIWing$`Contract.expires` <- as.Date(LoIWing$`Contract.expires`)
FilteredLoIWing <- LoIWing %>%
select(1:7,'Duels.won...', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90') %>%
filter(`Minutes.played` > 1200)
filter(`Contract.expires` < as.Date("2024-01-30"))
LoIWing$`Contract.expires` <- as.Date(LoIWing$`Contract.expires`)
FilteredData <- LoIWing %>%
filter(`Contract.expires` < as.Date("2024-01-30"))
View(FilteredData)
FilteredLoIWing <- LoIWing %>%
select(1:7,'Duels.won...', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90') %>%
filter(`Minutes.played` > 1200)
filter(`Contract.expires` < as.Date("2024-01-30"))
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won...', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90') %>%
filter(`Minutes.played` > 1200)
filter(`Contract.expires` < as.Date("2024-01-30"))
str(LoIWing)
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won...', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90') %>%
filter(`Minutes.played` > 1200)
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won...', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90') %>%
filter(`Minutes.played` > 1200)
filter(`Contract.expires` < as.Date("2024-01-30"))
LoIWing$`Contract.expires` <- as.Date(LoIWing$`Contract.expires`, "%Y-%m-%d")
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won...', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90') %>%
filter(`Minutes.played` > 1200)
filter(`Contract.expires` < as.Date("2024-01-30"))
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won...', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90') %>%
filter(`Minutes.played` > 1200)
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won...', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90') %>%
filter(`Minutes.played` > 1200)
filter(`Contract.expires` < as.Date("2024-01-30"))
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won...', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90') %>%
filter(`Contract.expires` < as.Date("2024-01-30"))
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won...', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90') %>%
filter(`Minutes.played` > 1200, `Contract.expires` < as.Date("2024-01-30"))
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won...', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90','Shots.on.target...', 'Accurate.crosses...', 'Crosses.from.left.flank.per.90', 'Crosses.from.right.flank.per.90', 'Key.passes.per.90', 'Through.passes.per.90', 'Passes.to.final.third.per.90') %>%
filter(`Minutes.played` > 1200, `Contract.expires` < as.Date("2024-01-30"))
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won...', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90','Shots.on.target...', 'Accurate.crosses...', 'Crosses.from.left.flank.per.90', 'Crosses.from.right.flank.per.90', 'Key.passes.per.90', 'Through.passes.per.90', 'Passes.to.final.third.per.90') %>%
filter(`Minutes.played` > 1000, `Contract.expires` < as.Date("2024-01-30"))
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won...', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90','Shots.on.target...', 'Accurate.crosses...', 'Crosses.from.left.flank.per.90', 'Crosses.from.right.flank.per.90', 'Key.passes.per.90', 'Through.passes.per.90', 'Passes.to.final.third.per.90') %>%
filter(`Minutes.played` > 1000, `Contract.expires` < as.Date("2024-01-30"), `Position` %in% c('LW', 'RW', 'RAMF', 'LAMF', 'RWF', 'LWF', 'RWB', 'LWB'))
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won...', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90','Shots.on.target...', 'Accurate.crosses...', 'Crosses.from.left.flank.per.90', 'Crosses.from.right.flank.per.90', 'Key.passes.per.90', 'Through.passes.per.90', 'Passes.to.final.third.per.90') %>%
filter(`Minutes.played` > 1000, `Contract.expires` < as.Date("2024-01-30"))
LoIWing <- LoIWing %>%
mutate(`Shots.on.target.per.90` = `Shots.on.target` / `Minutes.played` * 90)
LoIWing <- LoIWing %>%
mutate(`Shots.on.target.per.90` = `Shots.on.target...` / `Minutes.played` * 90)
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won...', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90','Shots.on.target.per.90', 'Accurate.crosses...', 'Crosses.from.left.flank.per.90', 'Crosses.from.right.flank.per.90', 'Key.passes.per.90', 'Through.passes.per.90', 'Passes.to.final.third.per.90') %>%
filter(`Minutes.played` > 1000, `Contract.expires` < as.Date("2024-01-30"))
LoIWing <- LoIWing %>%
mutate(`Shots.on.target.per.90` = `Shots.on.target...` / `Minutes.played` * 90,
`Duels.won.per.90` = `Duels.won...` / `Minutes.played` * 90)
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won.per.90', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90','Shots.on.target.per.90', 'Accurate.crosses...', 'Crosses.from.left.flank.per.90', 'Crosses.from.right.flank.per.90', 'Key.passes.per.90', 'Through.passes.per.90', 'Passes.to.final.third.per.90') %>%
filter(`Minutes.played` > 1000, `Contract.expires` < as.Date("2024-01-30"))
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won.per.90', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90','Shots.on.target.per.90', 'Accurate.crosses...', 'Crosses.from.left.flank.per.90', 'Crosses.from.right.flank.per.90', 'Key.passes.per.90', 'Through.passes.per.90', 'Passes.to.final.third.per.90') %>%
filter(`Minutes.played` > 1000, `Contract.expires` < as.Date("2024-01-30"), (`Position` %in% c('LAMF, LW','LW, LAMF', 'RW, RAMF', 'RAMF, RW', 'LAMF, RAMF', 'RAMF, LAMF', 'RAMF, RW, LAMF', 'LWF', 'RAMF, RW, RWF', 'RW, RB, RWB')))
Filtered2LoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won.per.90', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90','Shots.on.target.per.90', 'Accurate.crosses...', 'Crosses.from.left.flank.per.90', 'Crosses.from.right.flank.per.90', 'Key.passes.per.90', 'Through.passes.per.90', 'Passes.to.final.third.per.90') %>%
filter(`Minutes.played` > 1000, `Contract.expires` < as.Date("2024-01-30"))
View(Filtered2LoIWing)
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won.per.90', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90','Shots.on.target.per.90', 'Accurate.crosses...', 'Crosses.from.left.flank.per.90', 'Crosses.from.right.flank.per.90', 'Key.passes.per.90', 'Through.passes.per.90', 'Passes.to.final.third.per.90') %>%
filter(`Minutes.played` > 1000, `Contract.expires` < as.Date("2024-01-30"), (`Position` %in% c('LAMF, LW','LW, LAMF', 'RW, RAMF', 'RAMF, RW', 'LAMF, RAMF', 'RAMF, LAMF', 'RAMF, RW, LAMF', 'LWF', 'RAMF, RW, RWF', 'RW, RB, RWB', 'RWB, LWB', 'LWB, RWB', 'RB, RWB', 'RWB, RB', 'LWB, LB', 'LB, LWB')))
RankedLoIWing <- FilteredLoIWing %>%
mutate_at(vars(8, 10:21), list(rank = ~rank(desc(.))))
View(RankedLoIWing)
RankedLoIWing <- RankedLoIWing %>%
rowwise() %>%
mutate(Aggregate_Score = sum(c_across(starts_with("rank")))) %>%
ungroup()
RankedLoIWing <- RankedLoIWing %>%
rowwise() %>%
mutate(Aggregate_Score = sum(c_across(includes("rank")))) %>%
ungroup()
RankedLoIWing <- RankedLoIWing %>%
rowwise() %>%
mutate(Aggregate_Score = sum(c_across(include("rank")))) %>%
ungroup()
RankedLoIWing <- RankedLoIWing %>%
rowwise() %>%
mutate(Aggregate_Score = sum(c_across(select_if("rank")))) %>%
ungroup()
RankedLoIWing <- RankedLoIWing %>%
rowwise() %>%
mutate(Aggregate_Score = sum(c_across(ends_with("rank")))) %>%
ungroup()
FinalRanking <- RankedLoIWing %>%
arrange(desc(Aggregate_Score))
View(RankedLoIWing)
View(FinalRanking)
LoIWing <- LoIWing %>%
mutate(`Shots.on.target.per.90` = `Shots.on.target...` / `Minutes.played` * 90,
`Duels.won.per.90` = `Duels.won...` / `Minutes.played` * 90,
`Successful.dribbles.per.90` = `Successful.dribbles...` / `Minutes.played` * 90)
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won.per.90', 'Successful.dribbles.per.90', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90','Shots.on.target.per.90', 'Accurate.crosses...', 'Crosses.from.left.flank.per.90', 'Crosses.from.right.flank.per.90', 'Key.passes.per.90', 'Through.passes.per.90', 'Passes.to.final.third.per.90') %>%
filter(`Minutes.played` > 1000, `Contract.expires` < as.Date("2024-01-30"), (`Position` %in% c('LAMF, LW','LW, LAMF', 'RW, RAMF', 'RAMF, RW', 'LAMF, RAMF', 'RAMF, LAMF', 'RAMF, RW, LAMF', 'LWF', 'RAMF, RW, RWF', 'RW, RB, RWB', 'RWB, LWB', 'LWB, RWB', 'RB, RWB', 'RWB, RB', 'LWB, LB', 'LB, LWB')))
RankedLoIWing <- FilteredLoIWing %>%
mutate_at(vars(8, 9, 11:22), list(rank = ~rank(desc(.))))
RankedLoIWing <- RankedLoIWing %>%
rowwise() %>%
mutate(Aggregate_Score = sum(c_across(ends_with("rank")))) %>%
ungroup()
RankedLoIWing <- RankedLoIWing %>%
rowwise() %>%
mutate(Aggregate_Score = sum(c_across(ends_with("rank")))) %>%
ungroup()
FinalRanking <- RankedLoIWing %>%
arrange(desc(Aggregate_Score))
library(tidyverse)
LoIWing <- read.csv("/Users/seanmccrone/Desktop/MASTERS DEGREE/Course Material/B1701/Week 7/ClassPractical/LoIWingers.csv")
str(LoIWing)
# Convert 'Contract.expires' to Date format
LoIWing$`Contract.expires` <- as.Date(LoIWing$`Contract.expires`, "%Y-%m-%d")
# Create a new variable 'Shots.on.target.per.90'
LoIWing <- LoIWing %>%
mutate(`Shots.on.target.per.90` = `Shots.on.target...` / `Minutes.played` * 90,
`Duels.won.per.90` = `Duels.won...` / `Minutes.played` * 90,
`Successful.dribbles.per.90` = `Successful.dribbles...` / `Minutes.played` * 90)
# Filter data where 'Position' includes only the specified positions
FilteredData <- LoIWing %>%
filter(`Position` %in% c('LAMF, LW','LW, LAMF', 'RW, RAMF', 'RAMF, RW', 'LAMF, RAMF', 'RAMF, LAMF', 'RAMF, RW, LAMF', 'LWF', 'RAMF, RW, RWF', 'RW, RB, RWB'))
# Code to create a filtered dataset
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won.per.90', 'Successful.dribbles.per.90', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90','Shots.on.target.per.90', 'Accurate.crosses...', 'Crosses.from.left.flank.per.90', 'Crosses.from.right.flank.per.90', 'Key.passes.per.90', 'Through.passes.per.90', 'Passes.to.final.third.per.90') %>%
filter(`Minutes.played` > 1000, `Contract.expires` < as.Date("2024-01-30"), (`Position` %in% c('LAMF, LW','LW, LAMF', 'RW, RAMF', 'RAMF, RW', 'LAMF, RAMF', 'RAMF, LAMF', 'RAMF, RW, LAMF', 'LWF', 'RAMF, RW, RWF', 'RW, RB, RWB', 'RWB, LWB', 'LWB, RWB', 'RB, RWB', 'RWB, RB', 'LWB, LB', 'LB, LWB')))
# Define the weight for each variable
weightVector <- c('Goals' = 4, 'Assists' = 4, 'xG' = 4, 'xA' = 4, 'Shots.on.target.per.90' = 4,
'Duels.won.per.90' = 3, 'Successful.dribbles.per.90' = 3,
'Crosses.per.90' = 2, 'Accurate.crosses...' = 2, 'Crosses.from.left.flank.per.90' = 2,
'Crosses.from.right.flank.per.90' = 2,
'Key.passes.per.90' = 1, 'Through.passes.per.90' = 1, 'Passes.to.final.third.per.90' = 1)
# Code to rank players and create 'rank' variables
RankedLoIWing <- FilteredLoIWing %>%
mutate_at(
vars(8, 9, 11:22),
list(rank = ~rank(desc(.)))
)
# Code to create an aggregated score by weight
RankedLoIWing <- RankedLoIWing %>%
mutate(Aggregate_Score = rowSums(select(., ends_with("rank")) * weightVector))
# Code to re-order players in aggregate order
FinalRanking <- RankedLoIWing %>%
arrange(desc(Aggregate_Score))
View(FinalRanking)
library(tidyverse)
LoIWing <- read.csv("/Users/seanmccrone/Desktop/MASTERS DEGREE/Course Material/B1701/Week 7/ClassPractical/LoIWingers.csv")
str(LoIWing)
# Convert 'Contract.expires' to Date format
LoIWing$`Contract.expires` <- as.Date(LoIWing$`Contract.expires`, "%Y-%m-%d")
# Create a new variable 'Shots.on.target.per.90'
LoIWing <- LoIWing %>%
mutate(`Shots.on.target.per.90` = `Shots.on.target...` / `Minutes.played` * 90,
`Duels.won.per.90` = `Duels.won...` / `Minutes.played` * 90,
`Successful.dribbles.per.90` = `Successful.dribbles...` / `Minutes.played` * 90)
# Code to create a filtered dataset
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won.per.90', 'Successful.dribbles.per.90', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90','Shots.on.target.per.90', 'Accurate.crosses...', 'Crosses.from.left.flank.per.90', 'Crosses.from.right.flank.per.90', 'Key.passes.per.90', 'Through.passes.per.90', 'Passes.to.final.third.per.90') %>%
filter(`Minutes.played` > 1000, `Contract.expires` < as.Date("2024-01-30"), (`Position` %in% c('LAMF, LW','LW, LAMF', 'RW, RAMF', 'RAMF, RW', 'LAMF, RAMF', 'RAMF, LAMF', 'RAMF, RW, LAMF', 'LWF', 'RAMF, RW, RWF', 'RW, RB, RWB', 'RWB, LWB', 'LWB, RWB', 'RB, RWB', 'RWB, RB', 'LWB, LB', 'LB, LWB')))
# Code to rank players and create 'rank' variables
RankedLoIWing <- FilteredLoIWing %>%
mutate_at(vars(8, 9, 11:22), list(rank = ~rank(desc(.))))
# Code to create an aggregated score
RankedLoIWing <- RankedLoIWing %>%
rowwise() %>%
mutate(Aggregate_Score = sum(c_across(ends_with("rank")))) %>%
ungroup()
# Code to re-order players in aggregate order
FinalRanking2 <- RankedLoIWing %>%
arrange(desc(Aggregate_Score))
View(FinalRanking2)
library(tidyverse)
LoIWing <- read.csv("/Users/seanmccrone/Desktop/MASTERS DEGREE/Course Material/B1701/Week 7/ClassPractical/LoIWingers.csv")
str(LoIWing)
# Convert 'Contract.expires' to Date format
LoIWing$`Contract.expires` <- as.Date(LoIWing$`Contract.expires`, "%Y-%m-%d")
# Create a new variable 'Shots.on.target.per.90'
LoIWing <- LoIWing %>%
mutate(`Shots.on.target.per.90` = `Shots.on.target...` / `Minutes.played` * 90,
`Duels.won.per.90` = `Duels.won...` / `Minutes.played` * 90,
`Successful.dribbles.per.90` = `Successful.dribbles...` / `Minutes.played` * 90)
# Code to create a filtered dataset
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won.per.90', 'Successful.dribbles.per.90', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90','Shots.on.target.per.90', 'Accurate.crosses...', 'Crosses.from.left.flank.per.90', 'Crosses.from.right.flank.per.90', 'Key.passes.per.90', 'Through.passes.per.90', 'Passes.to.final.third.per.90') %>%
filter(`Minutes.played` > 1000, `Contract.expires` < as.Date("2024-01-30"), (`Position` %in% c('LAMF, LW','LW, LAMF', 'RW, RAMF', 'RAMF, RW', 'LAMF, RAMF', 'RAMF, LAMF', 'RAMF, RW, LAMF', 'LWF', 'RAMF, RW, RWF', 'RW, RB, RWB', 'RWB, LWB', 'LWB, RWB', 'RB, RWB', 'RWB, RB', 'LWB, LB', 'LB, LWB')))
# Define the weight for each variable
weightVector <- c('Goals_rank' = 4, 'Assists_rank' = 4, 'xG_rank' = 4, 'xA_rank' = 4, 'Shots.on.target.per.90_rank' = 4,
'Duels.won.per.90_rank' = 3, 'Successful.dribbles.per.90_rank' = 3,
'Crosses.per.90_rank' = 2, 'Accurate.crosses..._rank' = 2, 'Crosses.from.left.flank.per.90_rank' = 2,
'Crosses.from.right.flank.per.90_rank' = 2,
'Key.passes.per.90_rank' = 1, 'Through.passes.per.90_rank' = 1, 'Passes.to.final.third.per.90_rank' = 1)
# Code to rank players and create 'rank' variables
RankedLoIWing <- FilteredLoIWing %>%
mutate_at(
vars(8, 9, 11:22),
list(rank = ~rank(desc(.)))
)
# Code to create an aggregated score by weight
RankedLoIWing <- RankedLoIWing %>%
mutate(Aggregate_Score = rowSums(select(., ends_with("rank")) * weightVector))
# Code to re-order players in aggregate order
FinalRanking <- RankedLoIWing %>%
arrange(desc(Aggregate_Score))
library(tidyverse)
LoIWing <- read.csv("/Users/seanmccrone/Desktop/MASTERS DEGREE/Course Material/B1701/Week 7/ClassPractical/LoIWingers.csv")
str(LoIWing)
# Convert 'Contract.expires' to Date format
LoIWing$`Contract.expires` <- as.Date(LoIWing$`Contract.expires`, "%Y-%m-%d")
# Create a new variable 'Shots.on.target.per.90'
LoIWing <- LoIWing %>%
mutate(`Shots.on.target.per.90` = `Shots.on.target...` / `Minutes.played` * 90,
`Duels.won.per.90` = `Duels.won...` / `Minutes.played` * 90,
`Successful.dribbles.per.90` = `Successful.dribbles...` / `Minutes.played` * 90)
# Code to create a filtered dataset
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won.per.90', 'Successful.dribbles.per.90', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90','Shots.on.target.per.90', 'Accurate.crosses...', 'Crosses.from.left.flank.per.90', 'Crosses.from.right.flank.per.90', 'Key.passes.per.90', 'Through.passes.per.90', 'Passes.to.final.third.per.90') %>%
filter(`Minutes.played` > 1000, `Contract.expires` < as.Date("2024-01-30"), (`Position` %in% c('LAMF, LW','LW, LAMF', 'RW, RAMF', 'RAMF, RW', 'LAMF, RAMF', 'RAMF, LAMF', 'RAMF, RW, LAMF', 'LWF', 'RAMF, RW, RWF', 'RW, RB, RWB', 'RWB, LWB', 'LWB, RWB', 'RB, RWB', 'RWB, RB', 'LWB, LB', 'LB, LWB')))
# Define the weight for each variable
weightVector <- c('Goal' = 4, 'Assists' = 4, 'xG' = 4, 'xA' = 4, 'Shots.on.target.per.90' = 4,
'Duels.won.per.90' = 3, 'Successful.dribbles.per.90' = 3,
'Crosses.per.90' = 2, 'Accurate.crosses...' = 2, 'Crosses.from.left.flank.per.90' = 2,
'Crosses.from.right.flank.per.90' = 2,
'Key.passes.per.90' = 1, 'Through.passes.per.90' = 1, 'Passes.to.final.third.per.90' = 1)
# Code to rank players and create 'rank' variables
RankedLoIWing <- FilteredLoIWing %>%
mutate_at(
vars(8, 9, 11:22),
list(rank = ~rank(desc(.)))
)
# Code to create an aggregated score by weight
RankedLoIWing <- RankedLoIWing %>%
mutate(Aggregate_Score = rowSums(select(., ends_with("rank")) * weightVector))
# Code to re-order players in aggregate order
FinalRanking3 <- RankedLoIWing %>%
arrange(desc(Aggregate_Score))
View(FinalRanking3)
library(tidyverse)
LoIWing <- read.csv("/Users/seanmccrone/Desktop/MASTERS DEGREE/Course Material/B1701/Week 7/ClassPractical/LoIWingers.csv")
str(LoIWing)
# Convert 'Contract.expires' to Date format
LoIWing$`Contract.expires` <- as.Date(LoIWing$`Contract.expires`, "%Y-%m-%d")
# Create a new variable 'Shots.on.target.per.90'
LoIWing <- LoIWing %>%
mutate(`Shots.on.target.per.90` = `Shots.on.target...` / `Minutes.played` * 90,
`Duels.won.per.90` = `Duels.won...` / `Minutes.played` * 90,
`Successful.dribbles.per.90` = `Successful.dribbles...` / `Minutes.played` * 90)
# Code to create a filtered dataset
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won.per.90', 'Successful.dribbles.per.90', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90','Shots.on.target.per.90', 'Accurate.crosses...', 'Crosses.from.left.flank.per.90', 'Crosses.from.right.flank.per.90', 'Key.passes.per.90', 'Through.passes.per.90', 'Passes.to.final.third.per.90') %>%
filter(`Minutes.played` > 1000, `Contract.expires` < as.Date("2024-01-30"), (`Position` %in% c('LAMF, LW','LW, LAMF', 'RW, RAMF', 'RAMF, RW', 'LAMF, RAMF', 'RAMF, LAMF', 'RAMF, RW, LAMF', 'LWF', 'RAMF, RW, RWF', 'RW, RB, RWB', 'RWB, LWB', 'LWB, RWB', 'RB, RWB', 'RWB, RB', 'LWB, LB', 'LB, LWB')))
# Define the weight for each variable
weightVector <- c('Goals_rank' = 4, 'Assists_rank' = 4, 'xG_rank' = 4, 'xA_rank' = 4, 'Shots.on.target.per.90_rank' = 4,
'Duels.won.per.90_rank' = 3, 'Successful.dribbles.per.90_rank' = 3,
'Crosses.per.90_rank' = 2, 'Accurate.crosses..._rank' = 2, 'Crosses.from.left.flank.per.90_rank' = 2,
'Crosses.from.right.flank.per.90_rank' = 2,
'Key.passes.per.90_rank' = 1, 'Through.passes.per.90_rank' = 1, 'Passes.to.final.third.per.90_rank' = 1)
# Code to rank players and create 'rank' variables
RankedLoIWing <- FilteredLoIWing %>%
mutate_at(
vars(8, 9, 11:22),
list(rank = ~rank(desc(.)))
)
# Code to create an aggregated score by weight
RankedLoIWing <- RankedLoIWing %>%
mutate(Aggregate_Score = rowSums(select(., ends_with("rank")) * weightVector))
# Code to re-order players in aggregate order
FinalRanking <- RankedLoIWing %>%
arrange(desc(Aggregate_Score))
View(FinalRanking)
library(tidyverse)
LoIWing <- read.csv("/Users/seanmccrone/Desktop/MASTERS DEGREE/Course Material/B1701/Week 7/ClassPractical/LoIWingers.csv")
str(LoIWing)
# Convert 'Contract.expires' to Date format
LoIWing$`Contract.expires` <- as.Date(LoIWing$`Contract.expires`, "%Y-%m-%d")
# Create a new variable 'Shots.on.target.per.90'
LoIWing <- LoIWing %>%
mutate(`Shots.on.target.per.90` = `Shots.on.target...` / `Minutes.played` * 90,
`Duels.won.per.90` = `Duels.won...` / `Minutes.played` * 90,
`Successful.dribbles.per.90` = `Successful.dribbles...` / `Minutes.played` * 90)
# Code to create a filtered dataset
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won.per.90', 'Successful.dribbles.per.90', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90','Shots.on.target.per.90', 'Accurate.crosses...', 'Crosses.from.left.flank.per.90', 'Crosses.from.right.flank.per.90', 'Key.passes.per.90', 'Through.passes.per.90', 'Passes.to.final.third.per.90') %>%
filter(`Minutes.played` > 1000, `Contract.expires` < as.Date("2024-01-30"), (`Position` %in% c('LAMF, LW','LW, LAMF', 'RW, RAMF', 'RAMF, RW', 'LAMF, RAMF', 'RAMF, LAMF', 'RAMF, RW, LAMF', 'LWF', 'RAMF, RW, RWF', 'RW, RB, RWB', 'RWB, LWB', 'LWB, RWB', 'RB, RWB', 'RWB, RB', 'LWB, LB', 'LB, LWB')))
# Define the weight for each variable
weightVector <- c('Goals_rank' = 40, 'Assists_rank' = 40, 'xG_rank' = 40, 'xA_rank' = 40, 'Shots.on.target.per.90_rank' = 40,
'Duels.won.per.90_rank' = 30, 'Successful.dribbles.per.90_rank' = 30,
'Crosses.per.90_rank' = 20, 'Accurate.crosses..._rank' = 20, 'Crosses.from.left.flank.per.90_rank' = 20,
'Crosses.from.right.flank.per.90_rank' = 20,
'Key.passes.per.90_rank' = 10, 'Through.passes.per.90_rank' = 10, 'Passes.to.final.third.per.90_rank' = 10)
# Code to rank players and create 'rank' variables
RankedLoIWing <- FilteredLoIWing %>%
mutate_at(
vars(8, 9, 11:22),
list(rank = ~rank(desc(.)))
)
# Code to create an aggregated score by weight
RankedLoIWing <- RankedLoIWing %>%
mutate(Aggregate_Score = rowSums(select(., ends_with("rank")) * weightVector))
# Code to re-order players in aggregate order
FinalRanking <- RankedLoIWing %>%
arrange(desc(Aggregate_Score))
View(FinalRanking2)
View(FinalRanking3)
View(FinalRanking)
library(tidyverse)
LoIWing <- read.csv("/Users/seanmccrone/Desktop/MASTERS DEGREE/Course Material/B1701/Week 7/ClassPractical/LoIWingers.csv")
str(LoIWing)
# Convert 'Contract.expires' to Date format
LoIWing$`Contract.expires` <- as.Date(LoIWing$`Contract.expires`, "%Y-%m-%d")
# Create a new variable 'Shots.on.target.per.90'
LoIWing <- LoIWing %>%
mutate(`Shots.on.target.per.90` = `Shots.on.target...` / `Minutes.played` * 90,
`Duels.won.per.90` = `Duels.won...` / `Minutes.played` * 90,
`Successful.dribbles.per.90` = `Successful.dribbles...` / `Minutes.played` * 90)
# Code to create a filtered dataset
FilteredLoIWing <- LoIWing %>%
select(1:7,'Contract.expires', 'Duels.won.per.90', 'Successful.dribbles.per.90', 'Minutes.played','Goals', 'Assists', 'xG', 'xA', 'Crosses.per.90','Shots.on.target.per.90', 'Accurate.crosses...', 'Crosses.from.left.flank.per.90', 'Crosses.from.right.flank.per.90', 'Key.passes.per.90', 'Through.passes.per.90', 'Passes.to.final.third.per.90') %>%
filter(`Minutes.played` > 1000, `Contract.expires` < as.Date("2024-01-30"), (`Position` %in% c('LAMF, LW','LW, LAMF', 'RW, RAMF', 'RAMF, RW', 'LAMF, RAMF', 'RAMF, LAMF', 'RAMF, RW, LAMF', 'LWF', 'RAMF, RW, RWF', 'RW, RB, RWB', 'RWB, LWB', 'LWB, RWB', 'RB, RWB', 'RWB, RB', 'LWB, LB', 'LB, LWB')))
# Define the weight for each variable
weightVector <- c('Goals_rank' = 4, 'Assists_rank' = 4, 'xG_rank' = 4, 'xA_rank' = 4, 'Shots.on.target.per.90_rank' = 4,
'Duels.won.per.90_rank' = 3, 'Successful.dribbles.per.90_rank' = 3,
'Crosses.per.90_rank' = 2, 'Accurate.crosses..._rank' = 2, 'Crosses.from.left.flank.per.90_rank' = 2,
'Crosses.from.right.flank.per.90_rank' = 2,
'Key.passes.per.90_rank' = 1, 'Through.passes.per.90_rank' = 1, 'Passes.to.final.third.per.90_rank' = 1)
# Code to rank players and create 'rank' variables
RankedLoIWing <- FilteredLoIWing %>%
mutate_at(
vars(8, 9, 11:22),
list(rank = ~rank(desc(.)))
)
# Code to create an aggregated score by weight
RankedLoIWing <- RankedLoIWing %>%
mutate(Aggregate_Score = rowSums(select(., ends_with("rank")) * weightVector))
# Code to re-order players in aggregate order
FinalRanking <- RankedLoIWing %>%
arrange(desc(Aggregate_Score))
